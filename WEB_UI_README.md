# 🎵 声学信号分析Web界面使用指南

## 🚀 快速开始

### 1️⃣ 环境准备

确保您的系统已安装Python 3.7+：

```bash
python --version
```

### 2️⃣ 安装依赖

**方法一：自动安装（推荐）**
```bash
python start_web.py
```
启动脚本会自动检查并安装所需依赖。

**方法二：手动安装**
```bash
pip install -r requirements_web.txt
```

### 3️⃣ 启动Web界面

**方法一：使用启动脚本**
```bash
python start_web.py
```

**方法二：直接启动Streamlit**
```bash
streamlit run streamlit_app.py
```

### 4️⃣ 访问界面

启动成功后，浏览器会自动打开：
- 默认地址：http://localhost:8501
- 如果浏览器未自动打开，请手动访问上述地址 

---

## 📱 界面功能介绍

### 🎯 三种分析模式

#### 1. 单个文件分析
- **功能**：分析单个WAV音频文件
- **输出**：频谱图、共振峰分析图、综合分析图、CSV数据文件
- **适用场景**：快速分析单个音频样本

#### 2. 批量文件分析  
- **功能**：同时分析多个WAV文件
- **输出**：每个文件的独立分析结果
- **适用场景**：大批量数据处理，对比分析

#### 3. 专门共振峰分析
- **功能**：专注于共振峰的精确检测
- **输出**：详细的共振峰数据表和可视化图表
- **适用场景**：建筑声学研究，共振频率分析

### ⚙️ 分析参数设置

#### 基础参数
- **最大分析频率**：设置频谱分析的上限频率 (Hz)
- **启用综合分析**：是否生成时域+频域+相位+时频四维分析

#### 共振峰检测参数
- **最小突出度**：峰值相对周围的最小突出程度 (dB)
- **最小频率间隔**：相邻峰值间的最小频率距离 (Hz)  
- **最大检测峰值数**：限制检测的峰值数量

---

## 📊 分析结果说明

### 🎵 频谱图
- **横轴**：频率 (Hz)
- **纵轴**：声压级 (dB SPL)
- **用途**：显示声音在各频率上的能量分布

### 🎯 共振峰分析图
- **主图**：频谱曲线 + 共振峰标记
- **分布图**：共振峰频率分布直方图
- **强度图**：峰值强度气泡图
- **用途**：识别建筑结构的共振频率特征

### 📊 综合分析图
- **时域分析**：波形图和统计信息
- **频域分析**：频谱图和峰值标记
- **相位分析**：频率-相位关系图
- **时频分析**：短时傅里叶变换谱图

### 📋 CSV数据文件
包含详细的数值数据：
- 检测参数记录
- 统计信息汇总  
- 共振峰详细数据表
- 可直接用于Excel/SPSS等进一步分析

---

## 💾 结果下载

### 📦 下载包内容
- **图片文件**：所有分析生成的PNG图表
- **数据文件**：CSV格式的详细数据
- **文件组织**：按分析类型自动分类

### 📁 文件结构示例
```
analysis_results_20231206_143022.zip
├── ana_res/
│   ├── analysis_frequency_spectrum.png      # 频谱图
│   ├── analysis_resonance_peaks.png         # 共振峰图  
│   ├── analysis_resonance_peaks.csv         # 共振峰数据
│   ├── analysis_comprehensive_analysis.png  # 综合分析图
│   ├── analysis_time_domain.png            # 时域图
│   ├── analysis_phase_domain.png           # 相位图
│   └── analysis_spectrogram.png            # 时频图
```

---

## 🔧 使用技巧

### 📈 参数调优建议

**古建筑声学分析**
- 最小突出度：4-6 dB
- 最小频率间隔：5-10 Hz
- 分析频率范围：0-1000 Hz

**现代建筑分析**  
- 最小突出度：6-8 dB
- 最小频率间隔：10-15 Hz
- 分析频率范围：0-2000 Hz

**高精度研究**
- 最小突出度：2-4 dB
- 最小频率间隔：2-5 Hz
- 启用综合分析

### 📱 界面操作提示

1. **文件上传**：支持拖拽上传，推荐文件大小不超过50MB
2. **参数调整**：建议先用默认参数分析，再根据结果调优
3. **结果查看**：图片可以点击放大查看细节
4. **数据下载**：分析完成后及时下载，避免浏览器刷新丢失
5. **批量处理**：建议单次上传文件数不超过20个

---

## ❓ 常见问题

### Q: 支持哪些音频格式？
A: 目前仅支持WAV格式。如需分析其他格式，请先转换为WAV。

### Q: 分析速度慢怎么办？
A: 
- 降低最大分析频率
- 关闭综合分析（只做基础频谱分析）
- 减少批量处理的文件数量

### Q: 共振峰检测不准确？
A: 
- 调整最小突出度阈值
- 修改最小频率间隔
- 检查音频质量和噪声水平

### Q: 下载的ZIP文件打不开？
A: 
- 确保下载完整（检查文件大小）
- 尝试使用不同的解压软件
- 重新进行分析和下载

### Q: 界面无法访问？
A: 
- 检查防火墙设置
- 确认端口8501未被占用
- 尝试使用127.0.0.1:8501访问

---

## 🛠️ 技术支持

### 系统要求
- **操作系统**：Windows 10+, macOS 10.14+, Linux
- **Python版本**：3.7+
- **内存**：建议8GB+
- **浏览器**：Chrome, Firefox, Safari, Edge（最新版本）

### 依赖包版本
- streamlit >= 1.28.0
- numpy >= 1.21.0  
- matplotlib >= 3.5.0
- scipy >= 1.8.0
- pandas >= 1.4.0
- Pillow >= 8.3.0
- librosa >= 0.9.0

### 故障排除
如遇到问题，请检查：
1. Python和pip版本是否符合要求
2. 所有依赖包是否正确安装
3. 核心分析文件`wav_to_spectrum_analyzer.py`是否存在
4. 工作目录权限是否正确

---

## 📚 相关资源

- **项目主页**：声学信号分析工具
- **技术文档**：基于FFT的高精度频谱分析
- **学术应用**：建筑声学、音响工程、声学设计
- **开源协议**：遵循开源软件使用规范

---

*🎵 享受专业的声学分析体验！*
