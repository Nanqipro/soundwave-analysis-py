# 声学分析工具 v2.0 新功能使用指南

## 🎉 版本更新

专业版声学分析工具现已支持**参数定制化配置**，让您能够根据具体分析需求调节各种参数，获得最佳的分析结果。

## 🚀 快速启动

```bash
# 方法1：使用启动脚本（推荐）
python start_web.py

# 方法2：直接启动
streamlit run streamlit_app.py
```

启动后在浏览器中访问 `http://localhost:8501`

## 🔧 新增功能概览

### 1. **参数配置界面**
- 📊 **基础分析参数**：频率分辨率、最大分析频率、窗函数类型
- 🎯 **共振峰检测参数**：突出度阈值、频率间隔、峰值数量限制
- 📈 **时频分析参数**：STFT窗长度、窗重叠比例
- 🖼️ **显示控制参数**：时域显示时长、频率显示范围、综合分析开关

### 2. **五种预设配置**
- **建筑声学**：针对建筑空间声学分析优化
- **语音分析**：专门用于语音信号处理
- **音乐分析**：适合音乐和宽频信号分析
- **快速分析**：快速处理，降低计算时间
- **高精度分析**：最高精度设置，适合研究用途

### 3. **实时参数调节**
- 侧边栏实时调节参数
- 当前配置实时预览
- 参数说明和建议值
- 一键应用预设配置

### 4. **增强的结果展示**
- 显示分析使用的具体参数
- 更详细的分析结果摘要
- 改进的图表组织和展示

## 📋 详细参数说明

### 基础分析参数

#### 频率分辨率 (Hz)
- **范围**：0.001 - 1.0 Hz
- **默认值**：0.01 Hz
- **说明**：更小的值提供更高的频率精度，但计算时间更长
- **建议**：
  - 高精度研究：0.001-0.01 Hz
  - 常规分析：0.01-0.1 Hz
  - 快速分析：0.1-1.0 Hz

#### 最大分析频率 (Hz)
- **范围**：500 - 20000 Hz
- **默认值**：2000 Hz
- **说明**：限制分析的频率范围，建筑声学通常使用500-2000Hz
- **建议**：
  - 建筑声学：1000-2000 Hz
  - 语音分析：4000-8000 Hz
  - 音乐分析：16000-20000 Hz

#### 窗函数类型
- **选项**：hann, hamming, blackman, rectangular
- **默认值**：hann
- **说明**：
  - **hann**：通用，较好的频率分辨率
  - **hamming**：减少旁瓣，适合语音
  - **blackman**：最小旁瓣泄漏，适合高精度
  - **rectangular**：最高频率分辨率，但有旁瓣

### 共振峰检测参数

#### 最小突出度 (dB)
- **范围**：1.0 - 20.0 dB
- **默认值**：6.0 dB
- **说明**：峰值必须比周围至少突出的dB数
- **建议**：
  - 敏感检测：3-5 dB
  - 标准检测：6-8 dB
  - 严格检测：10-15 dB

#### 最小频率间隔 (Hz)
- **范围**：5.0 - 100.0 Hz
- **默认值**：10.0 Hz
- **说明**：相邻峰值之间的最小频率距离
- **建议**：
  - 高密度峰值：5-10 Hz
  - 标准间隔：10-20 Hz
  - 稀疏峰值：30-50 Hz

#### 最大检测峰值数
- **范围**：5 - 50
- **默认值**：20
- **说明**：限制检测的峰值数量，避免过多噪声峰值

### 时频分析参数

#### STFT窗长度
- **范围**：256 - 4096
- **默认值**：自动计算
- **说明**：
  - 更大的窗：更好的频率分辨率
  - 更小的窗：更好的时间分辨率

#### 窗重叠比例
- **范围**：0.1 - 0.9
- **默认值**：0.75
- **说明**：重叠比例越大，时频图越平滑

## 🎛️ 预设配置详解

### 建筑声学配置
```
频率分辨率: 0.01 Hz
最大分析频率: 2000 Hz
窗函数: hann
突出度阈值: 6.0 dB
频率间隔: 10.0 Hz
最大峰值数: 20
综合分析: 开启
```

### 语音分析配置
```
频率分辨率: 0.1 Hz
最大分析频率: 8000 Hz
窗函数: hamming
突出度阈值: 3.0 dB
频率间隔: 20.0 Hz
STFT窗长度: 512
窗重叠比例: 0.8
```

### 音乐分析配置
```
频率分辨率: 0.05 Hz
最大分析频率: 20000 Hz
窗函数: blackman
突出度阈值: 8.0 dB
频率间隔: 15.0 Hz
STFT窗长度: 2048
最大峰值数: 30
```

### 快速分析配置
```
频率分辨率: 0.5 Hz
最大分析频率: 2000 Hz
突出度阈值: 10.0 dB
频率间隔: 50.0 Hz
窗重叠比例: 0.5
综合分析: 关闭
```

### 高精度分析配置
```
频率分辨率: 0.001 Hz
最大分析频率: 4000 Hz
窗函数: blackman
突出度阈值: 3.0 dB
频率间隔: 5.0 Hz
STFT窗长度: 4096
窗重叠比例: 0.9
最大峰值数: 50
```

## 💡 使用技巧

### 1. 参数选择建议
- **首次使用**：建议选择对应的预设配置
- **研究用途**：使用高精度分析配置
- **快速预览**：使用快速分析配置
- **特殊需求**：在预设基础上微调参数

### 2. 性能优化
- 大文件分析时，适当调高频率分辨率值
- 关闭综合分析可显著提高处理速度
- 降低最大分析频率可减少计算量

### 3. 结果解读
- 查看"本次分析使用的配置参数"了解具体设置
- 比较不同参数设置的结果差异
- 关注共振峰检测结果的统计信息

## 🔧 技术特性

### 新增算法支持
- 自定义窗函数选择
- 可调节的共振峰检测算法
- 灵活的时频分析参数
- 智能参数验证机制

### 改进的用户体验
- 实时参数预览
- 清晰的参数说明
- 一键预设配置
- 详细的分析报告

### 兼容性保持
- 完全兼容之前版本的功能
- 原有的批量分析功能保持不变
- 支持相同的文件格式和输出

## 🚨 注意事项

1. **内存使用**：高精度设置（小频率分辨率）会增加内存使用
2. **处理时间**：精度越高，处理时间越长
3. **参数影响**：不同参数设置会显著影响分析结果
4. **文件大小**：大文件建议使用适中的参数设置

## 📞 技术支持

如果您在使用过程中遇到问题，请检查：

1. **依赖安装**：确保所有依赖包已正确安装
2. **文件格式**：确保使用的是支持的WAV文件格式
3. **参数设置**：检查参数是否在合理范围内
4. **系统资源**：确保有足够的内存和处理能力

---

**享受专业级声学分析体验！** 🎵✨
